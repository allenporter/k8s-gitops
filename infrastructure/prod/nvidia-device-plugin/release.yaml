---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: nvdp
spec:
  releaseName: nvdp
  chart:
    spec:
      # renovate: registryUrl=https://nvidia.github.io/k8s-device-plugin
      chart: nvidia-device-plugin
      version: 0.14.3
      sourceRef:
        kind: HelmRepository
        name: nvdp
        namespace: flux-system
  interval: 1h0m0s
  values:
    image:
      repository: nvcr.io/nvidia/k8s-device-plugin
      tag: v0.14.3
    gfd:
      # Automatically generate labels for GPUs
      enabled: true
    nodeSelector:
      accelerator: nvidia
    config:
      map:
        nvidia-plugin-configs: |-
          version: v1
          flags:
            migStrategy: none
