---
apiVersion: upgrade.cattle.io/v1
kind: Plan
metadata:
  name: os-upgrade
  namespace: system-upgrade
  labels:
    k3s-upgrade: server
spec:
  concurrency: 1
  # This is the version (tag) of the image to upgrade to.
  #
  # System is currently running
  # - Ubuntu 22.04
  # - v2.4.3-k3sv1.28.2+k3s1
  # To list different versions:
  #   sudo kairos-agent upgrade list-releases | grep "^22.04-standard-amd64-generic-v2.4"
  version: "22.04-standard-amd64-generic-v2.5.0-k3sv1.29.0-k3s1"
  nodeSelector:
    matchExpressions:
      - {key: kubernetes.io/hostname, operator: Exists}
  serviceAccountName: system-upgrade
  cordon: false
  drain:
    force: true
    disableEviction: true
  upgrade:
    image: quay.io/kairos/ubuntu
    command:
    - "/usr/sbin/suc-upgrade"
