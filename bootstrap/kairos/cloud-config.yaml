---
install:
  auto: true
  device: "auto"
  reboot: true
users:
- name: "admin"
  groups:
  - admin
  ssh_authorized_keys:
  - github:allenporter
k3s:
  enabled: true

stages:
  initramfs:
  - name: Increase number of open files
    sysctl:
      fs.inotify.max_user_instances: 8192
      fs.inotify.max_user_watches: 524288

boot:
- name: "Set up various kube environment variables"
  environment:
    KUBECONFIG: /etc/rancher/k3s/k3s.yaml
    CONTAINERD_ADDRESS: /run/k3s/containerd/containerd.sock
    CONTAINERD_NAMESPACE: k8s.io
