{
  extends: [
    'config:recommended',
    'customManagers:dockerfileVersions',
  ],
  timezone: 'America/Los_Angeles',
  assignees: [
    'allenporter',
  ],
  dependencyDashboardTitle: 'Renovate Dashboard',
  customManagers: [
    {
      customType: 'regex',
      managerFilePatterns: [
        '/.+\\.yaml$/',
      ],
      matchStrings: [
        'registryUrl=(?<registryUrl>.*?)\n *chart: (?<depName>.*?)\n *version: (?<currentValue>.*)\n',
      ],
      datasourceTemplate: 'helm',
    },
    {
      customType: 'regex',
      description: 'Raw GitHub URL Regex manager',
      managerFilePatterns: [
        '/.+\\.yaml$/',
      ],
      matchStrings: [
        'https:\\/\\/raw.githubusercontent.com\\/(?<depName>[\\w\\d\\-_]+\\/[\\w\\d\\-_]+)\\/(?<currentValue>[\\w\\d\\.\\-_]+)\\/.*',
      ],
      datasourceTemplate: 'github-releases',
      versioningTemplate: 'semver',
    },
    {
      customType: 'regex',
      managerFilePatterns: [
        '/.+\\.yaml$/',
      ],
      matchStrings: [
        '# renovate: datasource=(?<datasource>[a-z-]+?) depName=(?<depName>[^\\s]+?)(?: (lookupName|packageName)=(?<packageName>[^\\s]+?))?(?: versioning=(?<versioning>[^\\s]+?))?(?: registryUrl=(?<registryUrl>[^\\s]+?))?\\s.+?_version: (?<currentValue>.+?)\\s',
      ],
      extractVersionTemplate: '^v?(?<version>.*)$',
    },
  ],
  'helm-values': {
    managerFilePatterns: [
      '/.*(release|values|components)\\.yaml$/',
    ],
  },
  flux: {
    managerFilePatterns: [
      '/(?:^|/)gotk-components\\.yaml$/',
      '/kubernetes/clusters/prod/flux-system/.+\\.yaml$/',
      '/kubernetes/clusters/prod/sources/.+\\.yaml$/',
      '/(?:^|/)-values\\.yaml$/',
      '/(?:^|/)release\\.yaml$/',
    ],
  },
  packageRules: [
    {
      description: 'dev: Patches are automatic',
      matchFileNames: [
        '**/dev/*',
        '**/.devcontainer/*',
      ],
      automerge: true,
      automergeType: 'branch',
      additionalBranchPrefix: 'dev-',
      matchUpdateTypes: [
        'patch',
        'digest',
      ],
    },
    {
      description: 'dev: Minor updates automerged',
      matchFileNames: [
        '**/dev/*',
        '**/.devcontainer/*',
      ],
      automerge: true,
      additionalBranchPrefix: 'dev-minor',
      matchUpdateTypes: [
        'minor',
      ],
    },
    {
      description: 'dev: Major packages updated weekly',
      matchFileNames: [
        '**/dev/**',
        '**/.devcontainer/*',
      ],
      extends: [
        'schedule:weekends',
      ],
      additionalBranchPrefix: 'dev-major',
      matchUpdateTypes: [
        'major',
      ],
    },
    {
      description: 'prod: Patches are automatic after 1 day',
      matchFileNames: [
        '**/prod/**',
        '.github/workflows/**',
      ],
      automerge: true,
      automergeType: 'branch',
      minimumReleaseAge: '1 day',
      additionalBranchPrefix: 'prod-patch',
      matchUpdateTypes: [
        'patch',
      ],
    },
    {
      description: 'prod: Minor updates automerged weekly',
      matchFileNames: [
        '**/prod/**',
        '.github/workflows/**',
      ],
      automerge: true,
      extends: [
        'schedule:weekends',
      ],
      additionalBranchPrefix: 'prod-minor',
      minimumReleaseAge: '1 day',
      matchUpdateTypes: [
        'minor',
      ],
    },
    {
      description: 'prod: Packages updated weekly',
      matchFileNames: [
        '**/prod/**',
        '.github/workflows/**',
      ],
      extends: [
        'schedule:weekends',
      ],
      additionalBranchPrefix: 'prod-',
      minimumReleaseAge: '1 day',
      matchUpdateTypes: [
        'major',
        'minor',
      ],
    },
    {
      description: 'Development requirements: minor updates are silent',
      matchFileNames: [
        'requirements.txt',
        'Dockerfile',
      ],
      automerge: true,
      automergeType: 'branch',
      matchUpdateTypes: [
        'minor',
        'patch',
      ],
    },
    {
      description: 'Development requirements: updated weekly',
      matchFileNames: [
        'requirements.txt',
        'Dockerfile',
      ],
      extends: [
        'schedule:weekends',
      ],
      automerge: true,
      minimumReleaseAge: '1 day',
      matchUpdateTypes: [
        'major',
      ],
    },
    {
      description: 'supernote: Update immediately',
      matchPackageNames: [
        'ghcr.io/allenporter/supernote-lite',
      ],
      schedule: [],
      minimumReleaseAge: '0 days',
      automerge: true,
      automergeType: 'branch',
    },
  ],
  'pre-commit': {
    enabled: true,
  },
}
